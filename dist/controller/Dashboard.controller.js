sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/vbm/AnalyticMap","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/core/Fragment","sap/ui/core/format/DateFormat","sap/ui/core/format/NumberFormat"],function(e,a,t,s,o,r,n){"use strict";a.GeoJSONURL="./map/Mexico.JSON";var l;var i="/sap/opu/odata/sap/ZCDS_VENTAS_DASHBOARD_CDS";var d=new sap.ui.model.odata.v2.ODataModel(i,false);var u=r.getDateInstance({style:"medium",UTC:true});var c=n.getCurrencyInstance({decimalSeparator:".",groupingSeparator:","});return e.extend("geosales.geosales.controller.Dashboard",{onInit:function(){var e=this;d.bCanonicalRequests=true;d.setUseBatch(false);d.read("/ZCDS_VENTAS_DASHBOARD(p_date=datetime'2023-03-20T00:00:00',p_date_h=datetime'2023-03-20T00:00:00',p_time_l=time'PT12H01M00S',p_time_h=time'PT12H02M00S')/Set",{urlParameters:{$expand:"to_Totales,to_Recientes,to_TotalesEstado"},success:function(a){var t=0;var s=new sap.m.SlideTile;var o={};var r=a.results[0].to_Totales.results.length;var n=e.byId("totalesProductos");a.results[0].to_Totales.results.forEach(s=>{t++;var o="sap-icon://money-bills";var r="";var n="sapUiSmallMargin";switch(s.Producto){case"Celulares":o="sap-icon://iphone";r=r+" valueCelulares";break;case"Préstamo":o="sap-icon://loan";r=r+" valuePrestamos";s.Producto=s.Producto+"s";break;case"Motos":o="sap-icon://bus-public-transport";r=r+" valueMotos";break}var o;var l=a.results[0].p_date;var i=new sap.m.GenericTile({header:s.Producto,subheader:s.tipo_venta,headerImage:o,frameType:"TwoByOne",tileContent:new sap.m.TileContent({footer:u.format(l),content:new sap.m.FeedContent({value:s.total})})});i.addStyleClass(r);var d=new sap.m.SlideTile;var c=new sap.f.GridContainerItemLayoutData;c.setColumns(4);c.setMinRows(2);d.setLayoutData(c);d.addTile(i);e.byId("totalesProductos").addItem(d)});var l=[];a.results[0].to_TotalesEstado.results.forEach(a=>{e.byId("vbi").addRegion(new sap.ui.vbm.Region({tooltip:a.DescEstado,code:"MX-"+a.Estado,color:"#1b7eac"}));if(l.find(e=>e==a.Estado)){}else{l.push(a.Estado)}});t=1;var i=0;o={};r=a.results[0].to_Recientes.results.length;var d=[];a.results[0].to_Recientes.results.forEach(a=>{if(d.find(e=>e==a.Estado)){}else{d.push(a.Estado)}var s=new sap.m.GenericTile({header:a.Producto,subheader:a.tipo_venta,frameType:"OneByOne",tileContent:new sap.m.TileContent({footer:a.DescEstado,content:new sap.m.NumericContent({icon:"sap-icon://iphone",value:a.total,withMargin:false})})});i+=1;s.addStyleClass("iconCelulares");s.addStyleClass("myHeaderTile");var n=new sap.f.GridContainerItemLayoutData;n.setColumns(2);n.setMinRows(2);if(i<=3){o[t]=new sap.m.SlideTile;o[t].addTile(s);t++}else{if(t>3){t=1}o[t].addTile(s);t++}if(i==r){t=1;do{var l=new sap.f.Card;l.setContent(o[t]);l.addCustomData(new sap.m.BadgeCustomData({value:"Nueva venta"}));l.addStyleClass("sapUiSmallMarginBottom");e.byId("listRecientes").addItem(l);e.byId("listRecientes").setLayoutData(n);t++}while(t<=3)}});e.byId("legend02").setText(d.length+" estados registraron ventas en el último minuto");e.byId("legend01").setText(l.length+" estados han registrado ventas el día de hoy");d.forEach(a=>{e.byId("vbi").addRegion(new sap.ui.vbm.Region({code:"MX-"+a,color:"#F1B434"}))})}})}})});
//# sourceMappingURL=Dashboard.controller.js.map